5 'SAVE"OLED_GRP.BAS
10 SCREEN 2
20 DEFINT A-Z:DIM FT(96,8)
30 BLOAD"MSX0.SC2",S
100 _IOTINIT()
110 _IOTFIND("device/i2c_a",C):PRINTC
120 _IOTFIND("device/i2c_a",A$(0),C)
125 FOR I=0 TO C-1:PRINTA$(I):NEXTI
130 PT$="device/i2c_a/"+A$(0)
132 PRINT "READ FONT DATA"
135 FOR I=0 TO 95:FOR J=0 TO 7:READ A$:FT(I,J)=VAL("&H"+A$):NEXT J,I
140 'COMMAND_MODE
150 CM$ = CHR$(&H80)
160 'DATA_MODE
170 DM$ = CHR$(&H40)
180 DF = &HAE 'DISPLAY_OFF
190 DO = &HAF 'DISPLAY_ON
200 MEM$(0)="  MainRAM:16Kb"
210 MEM$(1)="  MainRAM:32Kb"
220 MEM$(2)="  MainRAM:64Kb"
230 MEM$(3)=" MainRAM:128Kb"
240 MEM$(4)=" MainRAM:256Kb"
250 MEM$(5)=" MainRAM:512Kb"
260 MEM$(6)=" MainRAM:1024Kb"
300 '------- MAIN
305 GOSUB 1000
310 GOSUB 2260
320 FOR Y=0 TO 55 STEP 8
330 R=Y/8:C=0:GOSUB 2330
340 FOR X=0 TO 127 STEP 8
350 DT$=""
360 FOR I=0 TO 7:D=0
370 FOR L=0 TO 7:A=2^L
380 C=POINT(X+I,Y+L):IF C=15 THEN D=D+A
390 NEXT L
400 DT$=DT$+CHR$(D)
410 NEXT I:GOSUB 7000
420 NEXT X,Y
430 R=6:C=0:GOSUB 2330
440 _IOTGET("conf/ram_size_id",MI)
450 ST$=MEM$(MI):GOSUB 2390
460 FOR I=0 TO 64:MC$=CHR$(&HD3)+CHR$(I):GOSUB 6000:NEXT
470 FOR I=0 TO 6:IF I MOD 2=0 THEN SC=&HA6 ELSE SC=&HA7
480 GOSUB 5000:NEXT
999 GOTO 999
1000 ' INIT
1005 PRINT "INIT"
1010 MC$=CHR$(&HC8)
1020 MC$=MC$+CHR$(&HC8) '[C0]/C8:Vertical drawing direction
1030 MC$=MC$+CHR$(&HA1) '[A0]/A1:Horizontal drawing direction
1040 MC$=MC$+CHR$(&HA8)+CHR$(&H3F) 'Screen Resolution 3F:64Line / 1F:32Line
1050 MC$=MC$+CHR$(&HDA)+CHR$(&H12) '[12]:Sequential / 02:Alternative
1060 MC$=MC$+CHR$(&HD3)+CHR$(&H0) 'Vertical offset
1070 MC$=MC$+CHR$(&H40) 'Vertical drawing start position
1080 MC$=MC$+CHR$(&HA6) 'A7:[A6] Color Inversion or Not
1090 MC$=MC$+CHR$(&H8D)+CHR$(&H14) 'Supply voltage of the OLED panel.Must be set to 14h.
1100 GOSUB 6000
1110 RETURN
2260 'CLEAR
2270 PRINT "CLEAR"
2280 SC=DF:GOSUB 5000
2290 FOR R=0 TO 7:C=0:GOSUB 2330
2300 ST$="                ":GOSUB 2390:NEXT R
2310 R=0:C=0:GOSUB 2330
2315 SC=DO:GOSUB 5000
2320 RETURN
2330 ' OLED SET CURSOR
2340 PRINT "LOCATE:";C;R
2350 MC$=CHR$(&HB0+R)
2360 MC$=MC$+CHR$(&H0+((8*C)AND15))
2370 MC$=MC$+CHR$(&H10+(((8*C)AND240)AND15)):GOSUB 6000
2380 RETURN
2390 'PUTS
2400 PRINT "PUTS:";ST$
2410 FOR L=1 TO LEN(ST$):MD$=MID$(ST$,L,1)
2420 C=ASC(MD$)-32
2430 DT$="":FOR K=0 TO 7:DT$=DT$+CHR$(FT(C,K)):NEXT K:GOSUB 7000
2440 '_IOTPUT(PT$,BF(C,J))
2450 NEXT L
2460 RETURN
5000 ' SEND COMMAND
5010 PRINT "SEND COMMAND:";HEX$(ASC(CM$));",";HEX$(SC)
5020 _IOTPUT(PT$,CM$+CHR$(SC))
5030 RETURN
6000 ' SEND MULTI COMMAND
6010 PRINT "SEND MULTICOMMAND:";HEX$(0);",";:FOR G=1 TO LEN(MC$):PRINT HEX$(ASC(MID$(MC$,G,1)));",";:NEXT:PRINT
6020 _IOTPUT(PT$,CHR$(0)+MC$)
6030 RETURN
7000 ' SEND DATA
7010 PRINT "SEND DATA:";HEX$(ASC(DM$));",";:FOR G=1 TO LEN(DT$):PRINT HEX$(ASC(MID$(DT$,G,1)));",";:NEXT:PRINT
7020 _IOTPUT(PT$,DM$+DT$)
7030 RETURN
20000 '----------- BASIC FONT
20010 DATA 00,00,00,00,00,00,00,00 'SPC
20020 DATA 00,00,5F,00,00,00,00,00 '!
20030 DATA 00,00,07,00,07,00,00,00 '"
20040 DATA 00,14,7F,14,7F,14,00,00
20050 DATA 00,24,2A,7F,2A,12,00,00
20060 DATA 00,23,13,08,64,62,00,00
20070 DATA 00,36,49,55,22,50,00,00
20080 DATA 00,00,05,03,00,00,00,00
20090 DATA 00,1C,22,41,00,00,00,00
20100 DATA 00,41,22,1C,00,00,00,00
20110 DATA 00,08,2A,1C,2A,08,00,00
20120 DATA 00,08,08,3E,08,08,00,00
20130 DATA 00,A0,60,00,00,00,00,00
20140 DATA 00,08,08,08,08,08,00,00
20150 DATA 00,60,60,00,00,00,00,00
20160 DATA 00,20,10,08,04,02,00,00
20170 DATA 00,3E,51,49,45,3E,00,00
20180 DATA 00,00,42,7F,40,00,00,00
20190 DATA 00,62,51,49,49,46,00,00
20200 DATA 00,22,41,49,49,36,00,00
20210 DATA 00,18,14,12,7F,10,00,00
20220 DATA 00,27,45,45,45,39,00,00
20230 DATA 00,3C,4A,49,49,30,00,00
20240 DATA 00,01,71,09,05,03,00,00
20250 DATA 00,36,49,49,49,36,00,00
20260 DATA 00,06,49,49,29,1E,00,00
20270 DATA 00,00,36,36,00,00,00,00
20280 DATA 00,00,AC,6C,00,00,00,00
20290 DATA 00,08,14,22,41,00,00,00
20300 DATA 00,14,14,14,14,14,00,00
20310 DATA 00,41,22,14,08,00,00,00
20320 DATA 00,02,01,51,09,06,00,00
20330 DATA 00,32,49,79,41,3E,00,00
20340 DATA 00,7E,09,09,09,7E,00,00
20350 DATA 00,7F,49,49,49,36,00,00
20360 DATA 00,3E,41,41,41,22,00,00
20370 DATA 00,7F,41,41,22,1C,00,00
20380 DATA 00,7F,49,49,49,41,00,00
20390 DATA 00,7F,09,09,09,01,00,00
20400 DATA 00,3E,41,41,51,72,00,00
20410 DATA 00,7F,08,08,08,7F,00,00
20420 DATA 00,41,7F,41,00,00,00,00
20430 DATA 00,20,40,41,3F,01,00,00
20440 DATA 00,7F,08,14,22,41,00,00
20450 DATA 00,7F,40,40,40,40,00,00
20460 DATA 00,7F,02,0C,02,7F,00,00
20470 DATA 00,7F,04,08,10,7F,00,00
20480 DATA 00,3E,41,41,41,3E,00,00
20490 DATA 00,7F,09,09,09,06,00,00
20500 DATA 00,3E,41,51,21,5E,00,00
20510 DATA 00,7F,09,19,29,46,00,00
20520 DATA 00,26,49,49,49,32,00,00
20530 DATA 00,01,01,7F,01,01,00,00
20540 DATA 00,3F,40,40,40,3F,00,00
20550 DATA 00,1F,20,40,20,1F,00,00
20560 DATA 00,3F,40,38,40,3F,00,00
20570 DATA 00,63,14,08,14,63,00,00
20580 DATA 00,03,04,78,04,03,00,00
20590 DATA 00,61,51,49,45,43,00,00
20600 DATA 00,7F,41,41,00,00,00,00
20610 DATA 00,02,04,08,10,20,00,00
20620 DATA 00,41,41,7F,00,00,00,00
20630 DATA 00,04,02,01,02,04,00,00
20640 DATA 00,80,80,80,80,80,00,00
20650 DATA 00,01,02,04,00,00,00,00
20660 DATA 00,20,54,54,54,78,00,00
20670 DATA 00,7F,48,44,44,38,00,00
20680 DATA 00,38,44,44,28,00,00,00
20690 DATA 00,38,44,44,48,7F,00,00
20700 DATA 00,38,54,54,54,18,00,00
20710 DATA 00,08,7E,09,02,00,00,00
20720 DATA 00,18,A4,A4,A4,7C,00,00
20730 DATA 00,7F,08,04,04,78,00,00
20740 DATA 00,00,7D,00,00,00,00,00
20750 DATA 00,80,84,7D,00,00,00,00
20760 DATA 00,7F,10,28,44,00,00,00
20770 DATA 00,41,7F,40,00,00,00,00
20780 DATA 00,7C,04,18,04,78,00,00
20790 DATA 00,7C,08,04,7C,00,00,00
20800 DATA 00,38,44,44,38,00,00,00
20810 DATA 00,FC,24,24,18,00,00,00
20820 DATA 00,18,24,24,FC,00,00,00
20830 DATA 00,00,7C,08,04,00,00,00
20840 DATA 00,48,54,54,24,00,00,00
20850 DATA 00,04,7F,44,00,00,00,00
20860 DATA 00,3C,40,40,7C,00,00,00
20870 DATA 00,1C,20,40,20,1C,00,00
20880 DATA 00,3C,40,30,40,3C,00,00
20890 DATA 00,44,28,10,28,44,00,00
20900 DATA 00,1C,A0,A0,7C,00,00,00
20910 DATA 00,44,64,54,4C,44,00,00
20920 DATA 00,08,36,41,00,00,00,00
20930 DATA 00,00,7F,00,00,00,00,00
20940 DATA 00,41,36,08,00,00,00,00
20950 DATA 00,02,01,01,02,01,00,00
20960 DATA 00,02,05,05,02,00,00,00
